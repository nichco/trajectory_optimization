from smt.surrogate_models import RBF, RMTB
import numpy as np
import matplotlib.pyplot as plt

xt = np.deg2rad(np.linspace(-90, 90, 181))
yt_cl = np.array([0,0,0,0,0,0,0,0,0,-0.002,-0.009,-0.016,-0.023,-0.03,-0.037,-0.044,-0.051,-0.058,
                -0.065,-0.072,-0.08,-0.09,-0.1,-0.11,-0.12,-0.13,-0.14,-0.15,-0.16,-0.17,-0.18,-0.19,
                -0.2,-0.21,-0.22,-0.23,-0.24,-0.25,-0.26,-0.27,-0.28,-0.29,-0.3,-0.31,-0.32,-0.33,-0.34,
                -0.35,-0.36,-0.37,-0.38,-0.39,-0.4,-0.41,-0.42,-0.43,-0.44,-0.45,-0.46,-0.47,-0.48,-0.49,
                -0.5,-0.51,-0.52,-0.53,-0.54,-0.55,-0.56,-0.57,-0.58,-0.59,-0.6,-0.61,-0.62,-0.63,-0.64,
                -0.65,-0.659,-0.665,-0.66,-0.65,-0.62,-0.568,-0.4854,-0.3957,-0.3076,-0.1436,0.0914,0.2692,0.401,
                0.5091,0.6101,0.7044,0.8008,0.8925,0.9747,1.0335,1.0833,1.1539,1.2206,1.2586,1.262,1.259,
                1.25,1.23,1.21,1.19,1.17,1.15,1.13,1.11,1.09,1.07,1.05,1.03,1.01,0.99,0.97,0.95,0.93,
                0.91,0.89,0.87,0.85,0.83,0.81,0.79,0.77,0.75,0.73,0.71,0.69,0.67,0.65,0.63,0.61,0.59,0.57,
                0.55,0.53,0.51,0.49,0.47,0.45,0.43,0.41,0.39,0.37,0.35,0.33,0.31,0.29,0.27,0.25,0.23,0.21,
                0.19,0.17,0.15,0.13,0.11,0.09,0.07,0.055,0.045,0.035,0.025,0.015,0.005,0,0,0,0,0,0,0,0,0,0,0])

yt_cd = np.array([1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,
                1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.19,1.19,1.18,1.175,1.17,1.16,1.15,
                1.14,1.125,1.115,1.09,1.06,1.02,0.99,0.95,0.9,0.85,0.803131468,0.767530626,0.730953264,
                0.694375903,0.657798541,0.62122118,0.584643818,0.548066457,0.511489095,0.479306071,
                0.43,0.39,0.35,0.32,0.27,0.23,0.20285,0.18013,0.16549,0.15658,0.13657,0.12271,0.11641,
                0.09726,0.08653,0.07473,0.06647,0.05788,0.05091,0.04659,0.04296,0.03895,0.03576,0.035,
                0.03,0.03,0.02778,0.02332,0.02039,0.01869,0.01702,0.01732,0.01669,0.01596,0.01561,
                0.01587,0.01666,0.01746,0.01837,0.01947,0.02223,0.02742,0.03392,0.04141,0.05186,0.06233,
                0.07,0.073,0.075,0.08,0.088,0.09923,0.10924,0.12493,0.14493,0.15622,0.17977,0.19094,
                0.20944,0.22779,0.25,0.27293,0.32,0.35,0.39,0.43,0.479306071,0.511489095,0.548066457,
                0.584643818,0.62122118,0.657798541,0.694375903,0.730953264,0.767530626,0.803131468,
                0.85,0.9,0.95,0.99,1.02,1.06,1.09,1.115,1.125,1.14,1.15,1.16,1.17,1.175,1.18,1.19,1.19,
                1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,
                1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2])

sm_cl = RBF(d0=0.1,print_global=False,print_solver=False,)
sm_cl.set_training_values(xt, yt_cl)
sm_cl.train()

sm_cd = RBF(d0=0.25,print_global=False,print_solver=False,)
sm_cd.set_training_values(xt, yt_cd)
sm_cd.train()

"""
num = 1000
x = np.deg2rad(np.linspace(-90, 90, num))

ycl = sm_cl.predict_values(x)
ycd = sm_cd.predict_values(x)

fig, (ax1, ax2) = plt.subplots(1, 2)
fig.suptitle('Aerodynamic Surrogate Models for NACA 2412')
ax1.plot(xt, yt_cl,'o',color='c')
ax1.plot(x, ycl,color='k')
ax1.set_ylabel('Cl')
ax1.set_xlabel('Alpha (rad)')
ax1.set_title('Lift')
ax2.plot(xt, yt_cd,'o',color='c')
ax2.plot(x, ycd,color='k')
ax2.set_ylabel('Cd')
ax2.set_xlabel('Alpha (rad)')
ax2.set_title('Drag')
plt.show()
"""