from smt.surrogate_models import RBF, RMTB
import numpy as np
import matplotlib.pyplot as plt

xt = np.deg2rad(np.linspace(-90, 90, 181))
buff = np.zeros(60)
yt_cl_center = np.array([0,0,0,0,0,0,0,0,0,0,
                -0,-0,-0.01,-0.02,-0.04,-0.07,-0.1,-0.17,-0.25,-0.37,
                -0.5314,-0.61,-0.6353,-0.568,-0.4854,-0.3957,-0.3076,-0.1436,0.0914,0.2692,
                0.401,0.5091,0.6101,0.7044,0.8008,0.8925,0.9747,1.0335,1.0833,1.1539,
                1.2206,1.2586,1.2148,1.1052,0.8,0.5,0.3,0.14,0.05,0.01,0,
                0,0,0,0,0,0,0,0,0,0])
yt_cl = np.append(np.append(buff,yt_cl_center),buff) # extends data through +/- 90 degrees

yt_cd = np.array([1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,
                1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.19,1.19,1.18,1.175,1.17,1.16,1.15,
                1.14,1.125,1.115,1.09,1.06,1.02,0.99,0.95,0.9,0.85,0.803131468,0.767530626,0.730953264,
                0.694375903,0.657798541,0.62122118,0.584643818,0.548066457,0.511489095,0.479306071,
                0.43,0.39,0.35,0.32,0.27,0.23,0.20285,0.18013,0.16549,0.15658,0.13657,0.12271,0.11641,
                0.09726,0.08653,0.07473,0.06647,0.05788,0.05091,0.04659,0.04296,0.03895,0.03576,0.035,
                0.03,0.03,0.02778,0.02332,0.02039,0.01869,0.01702,0.01732,0.01669,0.01596,0.01561,
                0.01587,0.01666,0.01746,0.01837,0.01947,0.02223,0.02742,0.03392,0.04141,0.05186,0.06233,
                0.07,0.073,0.075,0.08,0.088,0.09923,0.10924,0.12493,0.14493,0.15622,0.17977,0.19094,
                0.20944,0.22779,0.25,0.27293,0.32,0.35,0.39,0.43,0.479306071,0.511489095,0.548066457,
                0.584643818,0.62122118,0.657798541,0.694375903,0.730953264,0.767530626,0.803131468,
                0.85,0.9,0.95,0.99,1.02,1.06,1.09,1.115,1.125,1.14,1.15,1.16,1.17,1.175,1.18,1.19,1.19,
                1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2,
                1.2,1.2,1.2,1.2,1.2,1.2,1.2,1.2])

sm_cl = RBF(d0=0.1,print_global=False,print_solver=False,)
sm_cl.set_training_values(xt, yt_cl)
sm_cl.train()

sm_cd = RBF(d0=0.25,print_global=False,print_solver=False,)
sm_cd.set_training_values(xt, yt_cd)
sm_cd.train()

"""
num = 1000
x = np.deg2rad(np.linspace(-90, 90, num))

ycl = sm_cl.predict_values(x)

plt.plot(xt, yt_cl, "o")
plt.plot(x, ycl)
plt.xlabel("x")
plt.ylabel("y")
plt.legend(["Training data", "Prediction"])
plt.show()

ycd = sm_cd.predict_values(x)

plt.plot(xt, yt_cd, "o")
plt.plot(x, ycd)
plt.xlabel("x")
plt.ylabel("y")
plt.legend(["Training data", "Prediction"])
plt.show()
"""